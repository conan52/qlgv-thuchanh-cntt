@using TkbThucHanh.Models
@using TkbThucHanh.Models.Provider
@using TkbThucHanh.ViewSettings


@{
    var grid = Html.DevExpress().GridView(settings =>
    {

        
        
        
        
        settings.Name = "GridView";
       
        
        settings.CallbackRouteValues = new { Controller = "LichPhanCongThucHanh", Action = "GridViewPartial" };

        settings.SettingsEditing.AddNewRowRouteValues = new { Controller = "LichPhanCongThucHanh", Action = "GridViewPartialAddNew" };
        settings.SettingsEditing.UpdateRowRouteValues = new { Controller = "LichPhanCongThucHanh", Action = "GridViewPartialUpdate" };
        settings.SettingsEditing.DeleteRowRouteValues = new { Controller = "LichPhanCongThucHanh", Action = "GridViewPartialDelete" };
        settings.SettingDefaultColumn();

        settings.KeyFieldName = "MaLichTH";



        settings.Columns.Add(column =>
        {
            column.FieldName = "TuanHoc";
            column.Caption = "Tuần";
            column.Width = 45;
            column.ColumnType = MVCxGridViewColumnType.ComboBox;
            column.Visible = true;
            column.EditFormSettings.Visible = DefaultBoolean.True;
            var comboBoxProperties = column.PropertiesEdit as ComboBoxProperties;
            if (comboBoxProperties != null)
            {
                comboBoxProperties.DropDownStyle = DropDownStyle.DropDownList;
                comboBoxProperties.DataSource = DataProvider<TuanHoc>.GetAll();
                comboBoxProperties.ValueField = "SttTuan";
                comboBoxProperties.TextField = "SttTuan";
                comboBoxProperties.ValueType = typeof(int);
            }
        });

        settings.Columns.Add(column =>
        {
            column.FieldName = "NgayHoc";
            column.Caption = "Ngày học";
            column.Visible = false;
            column.EditFormSettings.Visible = DefaultBoolean.True;
            column.ColumnType = MVCxGridViewColumnType.DateEdit;
            var colProp = column.PropertiesEdit as DateEditProperties;
            colProp.MinDate = DateTime.Now;
            colProp.MaxDate = DateTime.Now.AddDays(14);
        });

        settings.Columns.Add(column =>
        {
            column.FieldName = "TietBatDau";
            column.Caption = "Từ tiết";
            column.Visible = false;
            column.EditFormSettings.Visible = DefaultBoolean.True;
            column.ColumnType = MVCxGridViewColumnType.ComboBox;
            var colProp = column.PropertiesEdit as ComboBoxProperties;
            colProp.DataSource = Enumerable.Range(1, 13);
        });

        settings.Columns.Add(column =>
        {
            column.FieldName = "TietKetThuc";
            column.Caption = "Đến tiết";
            column.Visible = false;
            column.EditFormSettings.Visible = DefaultBoolean.True;
            column.ColumnType = MVCxGridViewColumnType.ComboBox;
            var colProp = column.PropertiesEdit as ComboBoxProperties;
            colProp.DataSource = Enumerable.Range(1, 13);
        });


        settings.Columns.Add(column =>
        {
            column.FieldName = "Thu"; column.Width = 69;
            column.Caption = "Thứ";
            column.Visible = true;
            column.EditFormSettings.Visible = DefaultBoolean.False;
        });

        settings.Columns.Add(column =>
        {
            column.Width = 49;
            column.FieldName = "Tiet";
            column.Caption = "Tiết";
            column.Visible = true;
            column.EditFormSettings.Visible = DefaultBoolean.False;
        });

        settings.Columns.Add(column =>
        {
            column.Width = 49;
            column.FieldName = "SoTiet";
            column.Caption = "Số tiết";
            column.Visible = true;
            column.EditFormSettings.Visible = DefaultBoolean.False;
        });

        settings.Columns.Add(column =>
        {
            column.Width = 220;
            column.FieldName = "TenMonHoc";
            column.Caption = "Môn học";

            column.ColumnType = MVCxGridViewColumnType.ComboBox;
            var comboBoxProperties = column.PropertiesEdit as ComboBoxProperties;
            if (comboBoxProperties != null)
            {
                comboBoxProperties.IncrementalFilteringMode = IncrementalFilteringMode.Contains;
                comboBoxProperties.IncrementalFilteringDelay = 1000;
                comboBoxProperties.TextFormatString = "{1}";
                comboBoxProperties.DropDownStyle = DropDownStyle.DropDownList;
                comboBoxProperties.DataSource = DataProvider<MonHoc>.GetAll();
                comboBoxProperties.Columns.Add("MaMonHoc", "Mã môn học", 65);
                comboBoxProperties.Columns.Add("TenMonHoc", "Tên môn học", 250);
                comboBoxProperties.Columns.Add("HienThiTrinhDo", "Trình độ", 52);
                //    comboBoxProperties.Columns.Add("HienThiChuyenNganh", "Chuyên ngành", 78);
                comboBoxProperties.ValueField = "TenMonHoc";
                comboBoxProperties.TextField = "TenMonHoc";
            }
        });

        settings.Columns.Add(column =>
        {
            column.Width = 74;
            column.FieldName = "LopHoc";
            column.Caption = "Lớp";

            column.ColumnType = MVCxGridViewColumnType.ComboBox;
            var comboBoxProperties = column.PropertiesEdit as ComboBoxProperties;
            if (comboBoxProperties != null)
            {
                comboBoxProperties.IncrementalFilteringMode = IncrementalFilteringMode.Contains;
                comboBoxProperties.DropDownStyle = DropDownStyle.DropDownList;
                comboBoxProperties.DataSource = DataProvider<Lop>.GetAll();
                comboBoxProperties.ValueField = "TenLop";
                comboBoxProperties.TextField = "TenLop";
            }
        });


        settings.Columns.Add(column =>
        {
            column.Width = 49;
            column.FieldName = "Phong";
            column.Caption = "Phòng";

            column.ColumnType = MVCxGridViewColumnType.ComboBox;
            var comboBoxProperties = column.PropertiesEdit as ComboBoxProperties;
            if (comboBoxProperties != null)
            {
                comboBoxProperties.IncrementalFilteringMode = IncrementalFilteringMode.Contains;
                comboBoxProperties.TextFormatString = "{1}";
                comboBoxProperties.DropDownStyle = DropDownStyle.DropDownList;
                comboBoxProperties.DataSource = DataProvider<PhongThucHanh>.GetAll();


                comboBoxProperties.ValueField = "TenPhong";
                comboBoxProperties.TextField = "TenPhong";
            }
        });



        settings.Columns.Add(column =>
        {
            column.Width = 70;
            column.FieldName = "MaGv1";
            column.Caption = "GVHD1";

            column.ColumnType = MVCxGridViewColumnType.ComboBox;
            var comboBoxProperties = column.PropertiesEdit as ComboBoxProperties;
            if (comboBoxProperties != null)
            {
                comboBoxProperties.TextFormatString = "{1}";
                comboBoxProperties.DropDownStyle = DropDownStyle.DropDown;
                comboBoxProperties.IncrementalFilteringMode = IncrementalFilteringMode.Contains;
                comboBoxProperties.IncrementalFilteringDelay = 500;

                comboBoxProperties.DataSource = DataProvider<GiangVien>.GetAll();
                comboBoxProperties.Columns.Add("HoVaTen", "Họ và tên");
                comboBoxProperties.Columns.Add("TenNganGon", "Viết tắt");

                comboBoxProperties.ValueField = "MaGv";
                comboBoxProperties.TextField = "TenNganGon";
            }
        });

        settings.Columns.Add(column =>
        {
            column.Width = 70;
            column.FieldName = "MaGv2";
            column.Caption = "GVHD2";

            column.ColumnType = MVCxGridViewColumnType.ComboBox;
            var comboBoxProperties = column.PropertiesEdit as ComboBoxProperties;
            if (comboBoxProperties != null)
            {
                comboBoxProperties.TextFormatString = "{1}";
                comboBoxProperties.DropDownStyle = DropDownStyle.DropDown;
                comboBoxProperties.IncrementalFilteringMode = IncrementalFilteringMode.Contains;
                comboBoxProperties.IncrementalFilteringDelay = 500;
                comboBoxProperties.DataSource = DataProvider<GiangVien>.GetAll();
                comboBoxProperties.Columns.Add("HoVaTen", "Họ và tên");
                comboBoxProperties.Columns.Add("TenNganGon", "Viết tắt");

                comboBoxProperties.ValueField = "MaGv";
                comboBoxProperties.TextField = "TenNganGon";
            }
        });

        settings.Columns.Add(column =>
        {
            column.Width = 70;
            column.FieldName = "MaGv3";
            column.Caption = "GVHD3";

            column.ColumnType = MVCxGridViewColumnType.ComboBox;
            var comboBoxProperties = column.PropertiesEdit as ComboBoxProperties;
            if (comboBoxProperties != null)
            {
                comboBoxProperties.TextFormatString = "{1}";
                comboBoxProperties.DropDownStyle = DropDownStyle.DropDown;
                comboBoxProperties.IncrementalFilteringMode = IncrementalFilteringMode.Contains;
                comboBoxProperties.IncrementalFilteringDelay = 500;
                comboBoxProperties.DataSource = DataProvider<GiangVien>.GetAll();
                comboBoxProperties.Columns.Add("HoVaTen", "Họ và tên");
                comboBoxProperties.Columns.Add("TenNganGon", "Viết tắt");

                comboBoxProperties.ValueField = "MaGv";
                comboBoxProperties.TextField = "TenNganGon";
            }
        });
        settings.Columns.Add(column =>
        {
            column.Width = 65;
            column.FieldName = "GhiChu";
            column.Caption = "Ghi chú";

        });
        settings.Columns.Add(column =>
        {
            column.Width = 65;
            column.FieldName = "GvVang";
            column.Caption = "Vắng";

        });




        settings.SetCommandColumn();
    });
    if (ViewData["EditError"] != null)
    {
        grid.SetEditErrorText((string)ViewData["EditError"]);
    }
}
@grid.Bind(Model).GetHtml()